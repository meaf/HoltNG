package com.meaf.apeps.calculations.aggregate;

import com.meaf.apeps.input.csv.CSVRowParserTest;
import com.meaf.apeps.model.entity.WeatherStateData;
import org.junit.Assert;
import org.junit.Test;

import java.util.Arrays;
import java.util.List;
import java.util.stream.Collectors;

public class WeatherAggregatorTest {


  @Test
  public void aggregateOneDay(){

    List<String> strings = getTestData();
    List<WeatherStateData> inList = strings.stream().map(CSVRowParserTest::parse).collect(Collectors.toList());
    List<WeatherStateData> outList = WeatherAggregator.hourlyToDaily(inList);

    Assert.assertEquals(1, outList.size());


  }

  private List<String> getTestData() {
    return Arrays.asList(
        "2007-01-01T02:00:00Z,2007-01-01T01:00:00Z,PT60M,0.2,0,0,0,0,271,7.4",
        "2007-01-01T03:00:00Z,2007-01-01T02:00:00Z,PT60M,0.0,0,0,0,0,272,7.5",
        "2007-01-01T04:00:00Z,2007-01-01T03:00:00Z,PT60M,0.0,0,0,0,0,272,7.3",
        "2007-01-01T05:00:00Z,2007-01-01T04:00:00Z,PT60M,0.0,0,0,0,0,271,6.9",
        "2007-01-01T06:00:00Z,2007-01-01T05:00:00Z,PT60M,0.0,0,1,0,1,270,6.6",
        "2007-01-01T07:00:00Z,2007-01-01T06:00:00Z,PT60M,0.0,21,68,12,33,268,6.3",
        "2007-01-01T08:00:00Z,2007-01-01T07:00:00Z,PT60M,0.0,58,367,66,124,263,6.0",
        "2007-01-01T09:00:00Z,2007-01-01T08:00:00Z,PT60M,4.8,84,464,110,194,258,5.8",
        "2007-01-01T10:00:00Z,2007-01-01T09:00:00Z,PT60M,3.0,86,562,155,241,252,5.6",
        "2007-01-01T11:00:00Z,2007-01-01T10:00:00Z,PT60M,21.8,114,294,82,195,243,5.3",
        "2007-01-01T12:00:00Z,2007-01-01T11:00:00Z,PT60M,52.9,91,25,6,97,233,5.2",
        "2007-01-01T13:00:00Z,2007-01-01T12:00:00Z,PT60M,53.6,56,21,4,60,226,5.4",
        "2007-01-01T14:00:00Z,2007-01-01T13:00:00Z,PT60M,52.7,16,6,1,17,223,5.9",
        "2007-01-01T15:00:00Z,2007-01-01T14:00:00Z,PT60M,64.5,0,0,0,0,220,6.3",
        "2007-01-01T16:00:00Z,2007-01-01T15:00:00Z,PT60M,67.4,0,0,0,0,219,6.6",
        "2007-01-01T17:00:00Z,2007-01-01T16:00:00Z,PT60M,70.4,0,0,0,0,221,6.8",
        "2007-01-01T18:00:00Z,2007-01-01T17:00:00Z,PT60M,91.2,0,0,0,0,222,7.0",
        "2007-01-01T19:00:00Z,2007-01-01T18:00:00Z,PT60M,89.6,0,0,0,0,224,7.1",
        "2007-01-01T20:00:00Z,2007-01-01T19:00:00Z,PT60M,90.8,0,0,0,0,228,7.0",
        "2007-01-01T21:00:00Z,2007-01-01T20:00:00Z,PT60M,91.0,0,0,0,0,232,6.9",
        "2007-01-01T22:00:00Z,2007-01-01T21:00:00Z,PT60M,90.9,0,0,0,0,235,6.5",
        "2007-01-01T23:00:00Z,2007-01-01T22:00:00Z,PT60M,84.9,0,0,0,0,238,5.9",
        "2007-01-02T00:00:00Z,2007-01-01T23:00:00Z,PT60M,80.8,0,0,0,0,240,5.3",
        "2007-01-02T01:00:00Z,2007-01-02T00:00:00Z,PT60M,79.9,0,0,0,0,243,5.0",
        "2007-01-02T02:00:00Z,2007-01-02T01:00:00Z,PT60M,85.4,0,0,0,0,244,5.0",
        "2007-01-02T03:00:00Z,2007-01-02T02:00:00Z,PT60M,90.9,0,0,0,0,245,5.1",
        "2007-01-02T04:00:00Z,2007-01-02T03:00:00Z,PT60M,92.0,0,0,0,0,249,5.1",
        "2007-01-02T05:00:00Z,2007-01-02T04:00:00Z,PT60M,92.7,0,0,0,0,255,5.2",
        "2007-01-02T06:00:00Z,2007-01-02T05:00:00Z,PT60M,90.5,0,0,0,0,262,5.3",
        "2007-01-02T07:00:00Z,2007-01-02T06:00:00Z,PT60M,87.5,5,0,0,5,267,5.5",
        "2007-01-02T08:00:00Z,2007-01-02T07:00:00Z,PT60M,49.7,53,58,11,64,271,5.7",
        "2007-01-02T09:00:00Z,2007-01-02T08:00:00Z,PT60M,23.4,97,222,52,149,275,6.0",
        "2007-01-02T10:00:00Z,2007-01-02T09:00:00Z,PT60M,50.5,102,64,18,120,277,6.2",
        "2007-01-02T11:00:00Z,2007-01-02T10:00:00Z,PT60M,57.8,95,28,8,103,278,6.3",
        "2007-01-02T12:00:00Z,2007-01-02T11:00:00Z,PT60M,45.6,100,50,12,112,279,6.4",
        "2007-01-02T13:00:00Z,2007-01-02T12:00:00Z,PT60M,41.0,67,45,8,75,279,6.3",
        "2007-01-02T14:00:00Z,2007-01-02T13:00:00Z,PT60M,13.0,23,34,6,29,277,6.0",
        "2007-01-02T15:00:00Z,2007-01-02T14:00:00Z,PT60M,0.0,1,2,0,1,276,5.7",
        "2007-01-02T16:00:00Z,2007-01-02T15:00:00Z,PT60M,0.0,0,0,0,0,274,5.5",
        "2007-01-02T17:00:00Z,2007-01-02T16:00:00Z,PT60M,0.0,0,0,0,0,273,5.3",
        "2007-01-02T18:00:00Z,2007-01-02T17:00:00Z,PT60M,0.0,0,0,0,0,271,5.2",
        "2007-01-02T19:00:00Z,2007-01-02T18:00:00Z,PT60M,0.0,0,0,0,0,270,4.8",
        "2007-01-02T20:00:00Z,2007-01-02T19:00:00Z,PT60M,0.0,0,0,0,0,268,4.3",
        "2007-01-02T21:00:00Z,2007-01-02T20:00:00Z,PT60M,0.0,0,0,0,0,267,3.8",
        "2007-01-02T22:00:00Z,2007-01-02T21:00:00Z,PT60M,0.0,0,0,0,0,265,3.3",
        "2007-01-02T23:00:00Z,2007-01-02T22:00:00Z,PT60M,0.0,0,0,0,0,261,2.8",
        "2007-01-03T00:00:00Z,2007-01-02T23:00:00Z,PT60M,0.0,0,0,0,0,255,2.3",
        "2007-01-03T01:00:00Z,2007-01-03T00:00:00Z,PT60M,0.0,0,0,0,0,247,2.2",
        "2007-01-03T02:00:00Z,2007-01-03T01:00:00Z,PT60M,0.0,0,0,0,0,241,2.4",
        "2007-01-03T03:00:00Z,2007-01-03T02:00:00Z,PT60M,0.0,0,0,0,0,235,2.7",
        "2007-01-03T04:00:00Z,2007-01-03T03:00:00Z,PT60M,0.0,0,0,0,0,237,2.7",
        "2007-01-03T05:00:00Z,2007-01-03T04:00:00Z,PT60M,16.3,0,0,0,0,246,2.5",
        "2007-01-03T06:00:00Z,2007-01-03T05:00:00Z,PT60M,14.8,1,1,0,1,255,2.5",
        "2007-01-03T07:00:00Z,2007-01-03T06:00:00Z,PT60M,22.3,22,20,3,25,265,2.4",
        "2007-01-03T08:00:00Z,2007-01-03T07:00:00Z,PT60M,53.1,55,20,4,59,274,2.3",
        "2007-01-03T09:00:00Z,2007-01-03T08:00:00Z,PT60M,48.1,98,43,11,109,283,2.3",
        "2007-01-03T10:00:00Z,2007-01-03T09:00:00Z,PT60M,36.2,133,92,26,159,290,2.2",
        "2007-01-03T11:00:00Z,2007-01-03T10:00:00Z,PT60M,37.1,130,87,24,154,297,1.9",
        "2007-01-03T12:00:00Z,2007-01-03T11:00:00Z,PT60M,51.4,91,28,7,97,305,1.7",
        "2007-01-03T13:00:00Z,2007-01-03T12:00:00Z,PT60M,33.6,70,65,12,82,317,1.6",
        "2007-01-03T14:00:00Z,2007-01-03T13:00:00Z,PT60M,38.4,21,14,2,23,328,1.7",
        "2007-01-03T15:00:00Z,2007-01-03T14:00:00Z,PT60M,32.6,0,0,0,1,337,1.9");
  }


}
